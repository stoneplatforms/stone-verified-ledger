{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": [
    "entry_id",
    "issued_at",
    "subject_type",
    "subject_ref",
    "policy_version",
    "result",
    "report_hash",
    "key_id",
    "signature"
  ],
  "properties": {
    "entry_id": {
      "type": "string",
      "description": "Unique identifier for the ledger entry (ULID format)"
    },
    "issued_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the entry was issued"
    },
    "subject_type": {
      "type": "string",
      "enum": ["code", "document", "artifact", "repository"],
      "description": "Type of subject being verified"
    },
    "subject_ref": {
      "type": "string",
      "description": "Reference identifier for the subject"
    },
    "subject_locator": {
      "type": "string",
      "format": "uri",
      "description": "URL or locator for the subject"
    },
    "business_legal_name": {
      "type": "string",
      "description": "Legal name of the business"
    },
    "business_dba": {
      "type": "string",
      "description": "Doing Business As name"
    },
    "business_ein": {
      "type": "string",
      "description": "Employer Identification Number"
    },
    "business_address": {
      "type": "string",
      "description": "Business address"
    },
    "business_country": {
      "type": "string",
      "description": "Country where business is located"
    },
    "business_state": {
      "type": "string",
      "description": "State or province where business is located"
    },
    "business_industry": {
      "type": "string",
      "description": "Industry sector"
    },
    "business_website": {
      "type": "string",
      "format": "uri",
      "description": "Business website URL"
    },
    "business_contact_email": {
      "type": "string",
      "format": "email",
      "description": "Business contact email"
    },
    "app_name": {
      "type": "string",
      "description": "Name of the application, webapp, or executable"
    },
    "app_version": {
      "type": "string",
      "description": "Version number of the app"
    },
    "app_platform": {
      "type": "string",
      "description": "Platform compatibility (e.g., web, iOS, Android, Windows, Linux)"
    },
    "app_language": {
      "type": "string",
      "description": "Primary programming language(s)"
    },
    "app_framework": {
      "type": "string",
      "description": "Framework or library used"
    },
    "repository_url": {
      "type": "string",
      "format": "uri",
      "description": "Source code repository URL"
    },
    "license_type": {
      "type": "string",
      "description": "License type (e.g., MIT, Apache-2.0, proprietary)"
    },
    "artifact_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "SHA256 hash of the actual binary/artifact"
    },
    "verification_date": {
      "type": "string",
      "format": "date-time",
      "description": "When the verification was performed"
    },
    "verification_method": {
      "type": "string",
      "description": "Method used for verification"
    },
    "verified_by": {
      "type": "string",
      "description": "Entity or person who performed verification"
    },
    "compliance_standards": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Array of compliance standards met"
    },
    "verification_scope": {
      "type": "string",
      "description": "Scope of verification"
    },
    "risk_level": {
      "type": "string",
      "enum": ["low", "medium", "high"],
      "description": "Overall risk assessment"
    },
    "expires_at": {
      "type": "string",
      "format": "date-time",
      "description": "Expiration date if verification has validity period"
    },
    "related_entry_ids": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Array of related entry IDs"
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Array of tags for categorization"
    },
    "certificate_ids": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Array of certificate or credential IDs"
    },
    "dependencies": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Array of other verified components this depends on"
    },
    "ai_models_used": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Array of AI models used"
    },
    "notes": {
      "type": "string",
      "description": "Free-form notes or observations"
    },
    "policy_version": {
      "type": "string",
      "description": "Version of the verification policy used"
    },
    "result": {
      "type": "string",
      "enum": ["pass", "fail", "partial"],
      "description": "Verification result"
    },
    "scores": {
      "type": "object",
      "additionalProperties": {
        "type": "number",
        "minimum": 0,
        "maximum": 10
      },
      "description": "Scores for various metrics"
    },
    "report_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "SHA256 hash of the report data"
    },
    "key_id": {
      "type": "string",
      "description": "Identifier for the signing key used"
    },
    "signature": {
      "type": "string",
      "description": "Ed25519 signature in base64 format"
    }
  },
  "additionalProperties": false
}
